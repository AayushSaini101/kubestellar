# Packaging and Delivery

## status-addon

The [status-addon](https://github.ibm.com/dettori/status-addon) repo is the source of a RedHat-style operator. 

The operator is delivered by a Helm chart at `quay.io/pdettori/status-addon-chart`. Chart versioning? How is the chart built, pushed?

There is also a container image involved.

## KubeStellar

### Derived files

Some files in the kubestellar repo are derived from other files there.

#### Files generated by controller-gen

- `make manifests` generates the CustomeResourceDefinition files.

- `make generated` generates the deep copy code.

Both of the above are currently broken, see Issue 1611.

#### Files generated by code-generator

The files in [pkg/generated](../../../pkg/generated) are generated by [k/code-generator](https://github.com/kubernetes/code-generator). This generation is done at development time by the command `make codegenclients`. That command does only two things: (1) ensure the needed local copy of `code-generator`, and then (2) invoke [hack/update-codegen-clients.sh](../../../hack/update-codegen-clients.sh).

### Central container image

Currently at `ghcr.io/kubestellar/kubestellar/kubestellar-operator:0.20.0-alpha.1`.

`make ko-build-push` will create that image. `make ko-build-local` will make a local image for just the local platform.

### KubeStellar Operator Helm Chart

The source for a Helm chart is in [core-helm-chart](../../../core-helm-chart). `make chart` (re)derives it from local sources.

This chart creates (among other things) a `Deployment` object that runs a container from the image `ghcr.io/kubestellar/kubestellar/kubestellar-operator:0.20.0-alpha.1`.

### KubeFlex PostCreateHooks

There are two `PostCreateHook` objects defined in [config/postcreate-hooks](../../../config/postcreate-hooks).

- `ocm.yaml` adds `clusteradm` by running a container using the image `quay.io/kubestellar/clusteradm:0.7.1` which is built from [the OCM source](https://github.com/open-cluster-management-io/clusteradm) by a process that is being documented.
- `kubestellar.yaml` runs container image `quay.io/kubestellar/helm:v3.13.2` (which is built from [the Helm source](https://github.com/helm/helm) by a process that we need to document) to instantiate the chart from `oci://ghcr.io/kubestellar/kubestellar/kubestellar-operator-chart` (tag?), which is built by (what?) from (what? probably answered above).
